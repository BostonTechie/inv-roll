<h3>All data report</h3>

  <button style="float: right;" id="btnExport">EXPORT Excel</button>
 


<Table >
    <thead id="indexList">
    
       <tr>
      
           <th>Edit </th>
           <th>Name </th>
           <th>Date </th>
           <th>Beginning Balance </th>
           <th>Purchases </th>
           <th>Income </th>
           <th>Withdrawals </th>
           <th>Realized Gains/(Loss) </th>
           <th>Unrealized Gains/(Loss) </th>
           <th>Fees </th>
           <th>Ending Balance </th>
         

           <th style="background-color: #a5c926; text-align: center;">
                <a style="background-color: #a5c926"href="/index/home"> 
                    <img src="/images/564-5647199_home-sweet-home-clip-art.png" width="25" alt="home link">
                </a>
            </th>  
       </tr>
   </thead>
   <tbody>
    
    <% rollData.forEach ((rollData, index) => { %>
        <tr>
            <td>
                <a href="/index/<%=rollData.id %>"> 
                edit entry
            </td>
       
            <td><%=rollData.name%></td>
        
            <td><%=rollData.statementDate%></td>
        
            <td><div class='currencyRender'><%=rollData.beginningBalance%></div></td>
        
            <td><div class='currencyRender'><%=rollData.purchases%></div></td>
       
            <td><div class='currencyRender'><%=rollData.income%></div></td>
       
            <td><div class='currencyRender'><%=rollData.withdrawals%></div></td>
       
            <td> <div class='currencyRender'><%=rollData.realized%></div></td>
       
            <td><div class='currencyRender'><%=rollData.unrealized%></div></td>
      
            <td><div class='currencyRender'><%=rollData.fees%></div></td>
       
            <td><div class='currencyRender'><%=rollData.endingBalance%></div></td>

            <td><form action='/index/<%= rollData.id%>?_method=DELETE' method='POST'>
                <input class="hoverDelete" type="submit" value='Delete this item'> 
            </form></td>
        </tr>
   


    <% }) %>   

   </tbody>
</table>
   
<script src="/js/currencyRender.js"></script>
<script> $(document).ready( function () {


    // https://stackoverflow.com/questions/22317951/export-html-table-data-to-excel-using-javascript-jquery-is-not-working-properl?rq=1


    $('#example').DataTable();
    $("#btnExport").click(function() {
        let table = document.getElementsByTagName("table");
        TableToExcel.convert(table[0], { // html code may contain multiple tables so here we are referring to 1st table tag
           name: `export.xlsx`, // fileName you could use any name
           sheet: {
              name: 'Sheet 1' // sheetName
           }
        });
    });
} );


</script>
